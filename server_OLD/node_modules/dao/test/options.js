var dao = require('./..');

describe('Options', function() {

  it('should be stored in application', function() {
    var opts = { bar : "foo"}
      , app = dao.App(opts);

    app.options.should.equal(opts);
  });

  it('should be passed to plugins attach method', function() {
    var opts = { "p" : { bar : "foo" } }
      , app = dao.App(opts)

    var plugin = { name : "p", attach : function(o) {
      o.should.eql({ bar : "foo"});
    }}

    app.use(plugin);
  })

  it('plugin options should inherit from global config', function() {
    var opts = { "plugin" : { bar : "foo", baz : 1 } }
      , app = dao.App(opts)

    var plugin = { name : "plugin", attach : function(o) {
      o.should.eql({
        bar : "foo"
      , baz : 2
      , opt : "new"
      })
    }}

    app.use(plugin, { opt : "new",  baz : 2});
  })

})